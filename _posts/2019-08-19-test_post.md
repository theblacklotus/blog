---
layout: post
title:  "The Tech Behind Eon: Tooling!"
author: Andreas Fredriksson (dep/TBL)
author_link: https://twitter.com/deplinenoise
---

Eon represents four years of work and during this we made several iterations to
various tools and pipelines. I'll save the 3D scene packer and track loader for
separate posts, but this post will cover the other aspects of our pipeline.

## Code Builds

First things first: we use cross-compilation. Our build environment works on
Mac, Linux and Windows and produces both ADF floppy images and stand-alone test
programs, as well as a multitude of host tools. This section will cover some of
the details of our setup, as well as some history.

We started with a stripped down, assembly-only version of our A1200 demo system
(called NewAge for some reason). We got rid of all the C code and simplified
things down to the very basics. This is how early prototyping of things like
the rubber cube started, in plain 68k assembly.

# Welcome

euoeduoeh

Test code

```m68k
        XDEF	ScenePlayerDecompressBitplaneMasks
        @proc	ScenePlayerDecompressBitplaneMasks (a6:statep)

        IFGT	SP_PROFILE_LEVEL-0
          TBL_BEGIN_SCOPE "ScenePlayerDecompressBitplaneMasks"
        ENDC

        ; Fetch count of bitplane masks

        @areg	countp
        move.l	SP_COUNT_PTR(@statep),@countp

        @dreg	bitplane_masks_count
        move.b	(@countp)+,@bitplane_masks_count
        lsl.w	#8,@bitplane_masks_count
        move.b	(@countp)+,@bitplane_masks_count

        move.l	@countp,SP_COUNT_PTR(@statep)
        @kill	countp

        IFNE	SP_PRINTF_DEBUG
        Printf	"Num bitplane masks: %lx",@bitplane_masks_count
        ENDC

        ; Decompress bitplane masks

        tst.w	@bitplane_masks_count
        beq.s	.skipBitplaneMasks

        @reserve d0,a0-a1
        lea	SP_3BIT_DECODERSTATE(@statep),a0
        lea	SP_BITPLANEMASKS(@statep),a1
        move.w	@bitplane_masks_count,d0
        bsr	DecodeBitStream_3Bits_Words_Decode
        @unreserve d0,a0-a1
.skipBitplaneMasks

        @kill	bitplane_masks_count

        IFGT	SP_PROFILE_LEVEL-0
          TBL_END_SCOPE
        ENDC
```

Test image

![High-Level Profiler View](/assets/load-profile-zoomout.png)
